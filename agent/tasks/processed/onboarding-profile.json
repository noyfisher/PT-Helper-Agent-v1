{
  "type": "ios_feature",
  "mode": "pr",
  "title": "Onboarding Health Profile Questionnaire",
  "description": "Create a multi-step onboarding questionnaire that appears after the user signs in for the first time. This collects the user's health profile before they can access the main app. The questionnaire should feel like a guided, friendly intake form — one section at a time, not a giant form. After completing it, the profile is saved to Firestore under the user's document and the user is taken to the home page. If the user has already completed the profile (check Firestore), skip straight to the home page.",
  "requirements": [
    "Step 1 - Basic Info: First name, last name, date of birth, sex (male/female/other), height (feet and inches picker), weight (lbs input)",
    "Step 2 - Medical History: Multi-select list of common conditions (diabetes, high blood pressure, asthma, heart disease, arthritis, none). Free-text field for 'Other conditions'",
    "Step 3 - Surgical History: Yes/No toggle for 'Have you had any surgeries?'. If yes, show a list where user can add surgery entries (name of surgery + approximate year). Allow adding multiple surgeries",
    "Step 4 - Injury History: Yes/No toggle for 'Do you have any current or past injuries?'. If yes, show a list where user can add injury entries (body area + description + whether it is current or past). Allow adding multiple injuries",
    "Step 5 - Activity Level: Single-select from Sedentary / Lightly Active / Moderately Active / Very Active / Athlete. Optional text field for primary sport or activity",
    "Step 6 - Review and Submit: Show a summary of all entered data. Confirm button saves to Firestore and navigates to home page",
    "Progress indicator showing which step the user is on (e.g. Step 2 of 6)",
    "Back button to go to previous steps and edit answers",
    "Save the complete profile to Firestore under users/{uid}/profile",
    "RootView should check if the user has a completed profile. If not, show the onboarding flow. If yes, show ContentView (home page)",
    "ContentView becomes the home page — show a greeting with the user's name, and navigation links to app features"
  ],
  "deliverables": [
    {
      "path": "ios/PT-Helper/PT-Helper/Models/UserProfile.swift",
      "type": "new",
      "description": "Data model for the user's health profile including basic info, medical history, surgical history, injuries, and activity level"
    },
    {
      "path": "ios/PT-Helper/PT-Helper/ViewModels/OnboardingViewModel.swift",
      "type": "new",
      "description": "ViewModel managing the multi-step onboarding flow, form validation, step navigation, and Firestore save"
    },
    {
      "path": "ios/PT-Helper/PT-Helper/Views/OnboardingView.swift",
      "type": "new",
      "description": "Main onboarding container view with step progress indicator and navigation between steps"
    },
    {
      "path": "ios/PT-Helper/PT-Helper/Views/OnboardingSteps/BasicInfoStepView.swift",
      "type": "new",
      "description": "Step 1: Name, DOB, sex, height, weight inputs"
    },
    {
      "path": "ios/PT-Helper/PT-Helper/Views/OnboardingSteps/MedicalHistoryStepView.swift",
      "type": "new",
      "description": "Step 2: Multi-select medical conditions with other field"
    },
    {
      "path": "ios/PT-Helper/PT-Helper/Views/OnboardingSteps/SurgicalHistoryStepView.swift",
      "type": "new",
      "description": "Step 3: Surgery toggle and dynamic surgery entry list"
    },
    {
      "path": "ios/PT-Helper/PT-Helper/Views/OnboardingSteps/InjuryHistoryStepView.swift",
      "type": "new",
      "description": "Step 4: Injury toggle and dynamic injury entry list"
    },
    {
      "path": "ios/PT-Helper/PT-Helper/Views/OnboardingSteps/ActivityLevelStepView.swift",
      "type": "new",
      "description": "Step 5: Activity level selection and primary sport"
    },
    {
      "path": "ios/PT-Helper/PT-Helper/Views/OnboardingSteps/ProfileReviewStepView.swift",
      "type": "new",
      "description": "Step 6: Summary of all answers with confirm and submit button"
    },
    {
      "path": "ios/PT-Helper/PT-Helper/RootView.swift",
      "type": "update",
      "description": "Update to check Firestore for completed profile. If no profile, show OnboardingView. If profile exists, show ContentView"
    },
    {
      "path": "ios/PT-Helper/PT-Helper/ContentView.swift",
      "type": "update",
      "description": "Update to serve as the home page with user greeting and feature navigation links"
    }
  ],
  "context_files": [
    "ios/PT-Helper/PT-Helper/LoginView.swift",
    "ios/PT-Helper/PT-Helper/PT_HelperApp.swift",
    "docs/brief.md"
  ],
  "context": {
    "app_domain": "physical_therapy",
    "target_ios_version": "15.0+",
    "ui_framework": "SwiftUI",
    "architecture_pattern": "MVVM"
  }
}
